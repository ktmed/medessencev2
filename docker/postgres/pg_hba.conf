# PostgreSQL Client Authentication Configuration
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections
local   all             postgres                                peer
local   all             all                                     scram-sha-256

# IPv4 local connections:
host    all             postgres        127.0.0.1/32            scram-sha-256
host    all             postgres        ::1/128                 scram-sha-256

# Connections from Docker network (production secure settings)
host    radiology_db    meduser         172.20.0.0/16           scram-sha-256
host    radiology_db    meduser         172.21.0.0/16           scram-sha-256

# Backup user connections
host    radiology_db    backup_user     172.20.0.0/16           scram-sha-256
host    radiology_db    backup_user     172.21.0.0/16           scram-sha-256

# Monitoring connections
host    all             monitoring      172.21.0.0/16           scram-sha-256

# Replication connections (for future standby servers)
host    replication     replicator      172.20.0.0/16           scram-sha-256
host    replication     replicator      172.21.0.0/16           scram-sha-256

# Deny all other connections
host    all             all             0.0.0.0/0               reject